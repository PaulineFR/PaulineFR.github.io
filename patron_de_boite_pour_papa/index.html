<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patron de boite pour les jeux de papa</title>
    <style>

    input[type='range'] {
      overflow: hidden;
      width: 80px;
      -webkit-appearance: none;
    }
    
    input[type='range']::-webkit-slider-thumb {
      width: 10px;
      -webkit-appearance: none;
      height: 10px;
      cursor: pointer;
    border-radius: 15px;
    }

    #largeur {
      background-color: #8cfcfc;
    }

    #largeur::-webkit-slider-thumb {
      background: #000fff;
      box-shadow: -80px 0 0 80px #00ffff;
    }

    #hauteur {
      background-color: #90fdca;
    }

    #hauteur::-webkit-slider-thumb {
      background: #029450;
      box-shadow: -80px 0 0 80px #00ff88;
    }

    #profondeur {
      background-color: #fd92da;
    }

    #profondeur::-webkit-slider-thumb {
      background: #5f0340;
      box-shadow: -80px 0 0 80px #ff00aa;
    }

    </style>
</head>

<body onload="drawC();">
    <canvas id="canvas" width="1122" height="793"></canvas>
    <h1>Patron de boite pour les jeux de papa</h1>
    <h6>Reset</h6>
    <button onclick="drawC();" style="width: 50px;height: 20px;">Ø</button>
    <h6></h6>
    <input id="largeur" type="range" min="20" max="50" value="30" onchange="changeLargeur();" >
    <h6></h6>
    <input id="hauteur" type="range" min="20" max="50" value="30" onchange="changeHauteur();">
    <h6></h6>
    <input id="profondeur" type="range" min="20" max="50" value="30" onchange="changeProfondeur();">
    <h6>Download</h6>
    <a className="download-link" href="" download="monImage.png">⇓ here ⇓</a>
</body>

<script>
    var canevas = document.getElementById('canvas');
    var ctx = canevas.getContext('2d');
    console.log(convertCmToPx(21));
    console.log(convertCmToPx(29.7));
    console.log(convertCmToPx(1));

    /* pour télécharger le dessin */
    document.getElementsByTagName('a')[0].addEventListener("click", function (evt) {
        var dataURL = canevas.toDataURL();
        evt.target.href = dataURL;
    });

    /* change la taille de la largeur */
    function changeLargeur() {
    var texte = document.getElementsByTagName('h6')[1];
    var largeur = document.getElementById('largeur');
    ctx.lineWidth = largeur.value;
    texte.innerHTML = "Largeur : " + largeur.value + " mm (" + largeur.value/10 + "cm)";
        drawP();
    }

    /* change la taille de la hauteur */
    function changeHauteur() {
    var texte = document.getElementsByTagName('h6')[2];
    var hauteur = document.getElementById('hauteur');
    ctx.lineWidth = hauteur.value;
    texte.innerHTML = "Hauteur : " + hauteur.value + " mm (" + hauteur.value/10 + "cm)";
        drawP();
    }

    /* change la taille de la profondeur */
    function changeProfondeur() {
    var texte = document.getElementsByTagName('h6')[3];
    var profondeur = document.getElementById('profondeur');
    ctx.lineWidth = profondeur.value;
    texte.innerHTML = "Profondeur : " + profondeur.value + " mm (" + profondeur.value/10 + "cm)";
        drawP();
    }

    /* convertit les cm en pixels */
    function convertCmToPx(mm) {
        return (96 / 2.54) * mm;        // https://www.pixelto.net/cm-to-px-converter
    }

    /* convertit les pixels en cm */
    function convertPxToCm(px) {
        return (2.54 / 96) * px;    // https://www.pixelto.net/px-to-cm-converter
    }

    /* dessine le patron */
    function drawP() {
        var largeur = document.getElementById('largeur');
        var hauteur = document.getElementById('hauteur');
        var profondeur = document.getElementById('profondeur');
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.moveTo(convertCmToPx(10), convertCmToPx(10));
        ctx.lineTo(convertCmToPx(10), largeur.value*5);
        ctx.moveTo(convertCmToPx(10), convertCmToPx(10));
        ctx.lineTo(hauteur.value*5, convertCmToPx(10));
        ctx.moveTo(convertCmToPx(10), convertCmToPx(10));
        let pythagore = Math.round(Math.sqrt(Math.pow(profondeur.value,2)/2));
        ctx.lineTo(pythagore*5, pythagore*5); // pythagore
        ctx.stroke();
        console.log(pythagore);
        /*

        pv² = x² + y²
        x = y

        pv² = x.x + y.y = x.x + x.x = 2(x²)
        (pv²)/2 = x²
        rac((pv²)/2) = x

        */
    }

    /* dessine le canevas */
    function drawC() {
        var texteL = document.getElementsByTagName('h6')[1];
        var largeur = document.getElementById('largeur');
        var texteH = document.getElementsByTagName('h6')[2];
        var hauteur = document.getElementById('hauteur');
        var texteP = document.getElementsByTagName('h6')[3];
        var profondeur = document.getElementById('profondeur');
        largeur.value = 30;
        hauteur.value = 30;
        profondeur.value = 30;
        ctx.lineWidth = 2;
        ctx.lineCap = 'round';
        ctx.lineJoin = 'round';
        //console.log(bgColor.value);
        ctx.fillStyle = "#ffffff";
        ctx.fillRect(1, 1, canvas.width - 2, canvas.height - 2);
        texteL.innerHTML = "Largeur : " + largeur.value + " mm (" + largeur.value/10 + "cm)";
        texteH.innerHTML = "Hauteur : " + hauteur.value + " mm (" + largeur.value/10 + "cm)";
        texteP.innerHTML = "Profondeur : " + profondeur.value + " mm (" + largeur.value/10 + "cm)";
        ctx.strokeStyle = "#000000"
        ctx.beginPath();
        ctx.moveTo(0, 0);
        ctx.lineTo(0, 793);
        ctx.lineTo(1122, 793);
        ctx.lineTo(1122, 0);
        ctx.lineTo(0, 0);
        ctx.stroke();
        //tests 1cm
        ctx.beginPath();
        ctx.moveTo(10, 10);
        ctx.lineTo(10, 37+10);
        ctx.stroke();
    }
</script>

</html>